set allow_8bit
set smart_wrap
set reverse_name
set reverse_realname
set reflow_text
set wrap = 80
#set sidebar_visible
set wait_key = no
set confirm_append = no
set editor = vim
set sort_aux = last-date-received
set mailcap_path = "$XDG_CONFIG_HOME/mutt/mailcap"
set date_format = "%d.%m.%y %I:%M"
set index_format = "%3C %Z %d  %-30.30F  %s  (%-2.4c)"

# Mandatory setting to be able to sync via offlineimap!
# The default is mbox which is basically a file and will not be synced back to
# the imap-server via offlineimap.
set mbox_type=Maildir

source "$XDG_CONFIG_HOME/mutt/gruvbox.muttrc"
color index_author color167 color234
color index_size color142 color234
color index_date color214 color234
color status color220 color235
#color markers     color234 color234

auto_view text/plain text/html text/calendar application/ics
alternative_order text/plain text/html text/calendar application/ics

bind index 0 first-entry
bind index G last-entry

bind pager 0 top
bind pager G bottom
bind pager j next-line
bind pager k previous-line
bind pager <Backspace> previous-entry
bind pager <Enter> next-entry
bind pager <Return> next-entry
bind attach i exit
bind pager,attach q noop

bind pager,index \ch sidebar-toggle-visible
bind pager,index \cj sidebar-next
bind pager,index \ck sidebar-prev
bind pager,index \co sidebar-open
bind pager,index c mail

bind pager,index,attach g noop # unbind g to be used with macros, e.g. gg
bind pager,index m noop # unbind M to be used with macros, e.g. mv

macro index gg "<first-entry>"
macro index gr "<imap-fetch-mail>"

macro pager gg "<top>"
macro pager gn "<next-entry>"
macro pager gp "<previous-entry>"
macro pager gr "<group-reply>"
# Allow urlscan to follow links additional of the builtin urlview
macro index,pager,attach gu '<pipe-message>urlscan<enter>' "Follow links with urlscan"
macro index,pager,attach go '<pipe-message>urlscan --headers -d -W<enter>' "Follow links with urlscan"
macro attach gf "<enter-command>unset wait_key<enter><shell-escape>rm -f ~/Downloads/mutt-attach<enter><save-entry><kill-line>~/Downloads/mutt-attach<enter><shell-escape>firefox ~/Downloads/mutt-attach &<enter>" "Open attachent in firefox"
# Neither builtin urlview nor urlscan really worked great on stupid marketing mails, so w3m for the rescue...
macro index,pager,attach gv "<view-attachments><search>text/html<enter><pipe-message>w3m -T text/html -o imgdisplay= -o confirm_qq=false<enter><exit>"

macro index mv "<tag-prefix><save-message>?" "move message to chosen folder"
macro pager mv "<save-message>?" "move message to chosen folder"

# I prefer so see the IMAP folders instead of my mailboxes by default
macro index,pager y "<change-folder>?<toggle-mailboxes><change-dir>$folder<enter>" "show incoming mailboxes list"

# Switch between accounts
macro index <f2> "<sync-mailbox><enter-command>source $XDG_CONFIG_HOME/mutt/account.info.nehrke_felix.muttrc<enter><change-folder>=INBOX<enter>"
macro index <f3> "<sync-mailbox><enter-command>source $XDG_CONFIG_HOME/mutt/account.com.gmail_nemoinho.muttrc<enter><change-folder>=INBOX<enter>"

# Source my default account
source "$XDG_CONFIG_HOME/mutt/account.info.nehrke_felix.muttrc"
#source "$XDG_CONFIG_HOME/mutt/account.com.gmail_nemoinho.muttrc"
